<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云端上传测试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 20px; margin: 10px; }
        #result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>🧪 Google Sheets 上传测试</h1>
    
    <button onclick="testUpload()">测试上传到云端</button>
    <button onclick="testBatchUpload()">测试批量上传</button>
    
    <div id="result"></div>

    <script>
        async function testUpload() {
            const result = document.getElementById('result');
            result.innerHTML = '🔄 正在测试单条上传...';
            result.className = '';
            
            const testData = [{
                expressType: 'UPS',
                processedCode: '1Z999AA1234567890'
            }];
            
            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbzsoQ_1QyVC09mTBAgLt7KXK9kooB6zvwlOfBOOqRXMD_EiQf3m6mOhdLYcLSMwqS4v/AKfycby6-gUV8LaKPnDDBGT5U5nC3WR4KnNb-4-E4Q6rY-trAMcabRzw4gCOa8S582NpPMNn/exec", {
                    method: "POST",
                    body: JSON.stringify(testData),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                
                if (response.ok) {
                    const responseText = await response.text();
                    result.innerHTML = `✅ 上传成功！<br>响应: ${responseText}`;
                    result.className = 'success';
                } else {
                    result.innerHTML = `❌ 上传失败！<br>状态码: ${response.status}<br>状态文本: ${response.statusText}`;
                    result.className = 'error';
                }
            } catch (error) {
                result.innerHTML = `❌ 网络错误！<br>错误信息: ${error.message}`;
                result.className = 'error';
            }
        }
        
        async function testBatchUpload() {
            const result = document.getElementById('result');
            result.innerHTML = '🔄 正在测试批量上传...';
            result.className = '';
            
            const testData = [
                { expressType: 'UPS', processedCode: '1Z999AA1234567890' },
                { expressType: 'FedEx', processedCode: '123456789012' },
                { expressType: 'USPS', processedCode: '9400123456789012345678' }
            ];
            
            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbzsoQ_1QyVC09mTBAgLt7KXK9kooB6zvwlOfBOOqRXMD_EiQf3m6mOhdLYcLSMwqS4v/AKfycby6-gUV8LaKPnDDBGT5U5nC3WR4KnNb-4-E4Q6rY-trAMcabRzw4gCOa8S582NpPMNn/exec", {
                    method: "POST",
                    body: JSON.stringify(testData),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                
                if (response.ok) {
                    const responseText = await response.text();
                    result.innerHTML = `✅ 批量上传成功！<br>上传了 ${testData.length} 条记录<br>响应: ${responseText}`;
                    result.className = 'success';
                } else {
                    result.innerHTML = `❌ 批量上传失败！<br>状态码: ${response.status}<br>状态文本: ${response.statusText}`;
                    result.className = 'error';
                }
            } catch (error) {
                result.innerHTML = `❌ 网络错误！<br>错误信息: ${error.message}`;
                result.className = 'error';
            }
        }
    </script>
</body>
</html>