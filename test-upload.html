<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‘ç«¯ä¸Šä¼ æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 20px; margin: 10px; }
        #result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Google Sheets ä¸Šä¼ æµ‹è¯•</h1>
    
    <button onclick="testUpload()">æµ‹è¯•ä¸Šä¼ åˆ°äº‘ç«¯</button>
    <button onclick="testBatchUpload()">æµ‹è¯•æ‰¹é‡ä¸Šä¼ </button>
    
    <div id="result"></div>

    <script>
        async function testUpload() {
            const result = document.getElementById('result');
            result.innerHTML = 'ğŸ”„ æ­£åœ¨æµ‹è¯•å•æ¡ä¸Šä¼ ...';
            result.className = '';
            
            const testData = [{
                expressType: 'UPS',
                processedCode: '1Z999AA1234567890'
            }];
            
            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbzsoQ_1QyVC09mTBAgLt7KXK9kooB6zvwlOfBOOqRXMD_EiQf3m6mOhdLYcLSMwqS4v/AKfycby6-gUV8LaKPnDDBGT5U5nC3WR4KnNb-4-E4Q6rY-trAMcabRzw4gCOa8S582NpPMNn/exec", {
                    method: "POST",
                    body: JSON.stringify(testData),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                
                if (response.ok) {
                    const responseText = await response.text();
                    result.innerHTML = `âœ… ä¸Šä¼ æˆåŠŸï¼<br>å“åº”: ${responseText}`;
                    result.className = 'success';
                } else {
                    result.innerHTML = `âŒ ä¸Šä¼ å¤±è´¥ï¼<br>çŠ¶æ€ç : ${response.status}<br>çŠ¶æ€æ–‡æœ¬: ${response.statusText}`;
                    result.className = 'error';
                }
            } catch (error) {
                result.innerHTML = `âŒ ç½‘ç»œé”™è¯¯ï¼<br>é”™è¯¯ä¿¡æ¯: ${error.message}`;
                result.className = 'error';
            }
        }
        
        async function testBatchUpload() {
            const result = document.getElementById('result');
            result.innerHTML = 'ğŸ”„ æ­£åœ¨æµ‹è¯•æ‰¹é‡ä¸Šä¼ ...';
            result.className = '';
            
            const testData = [
                { expressType: 'UPS', processedCode: '1Z999AA1234567890' },
                { expressType: 'FedEx', processedCode: '123456789012' },
                { expressType: 'USPS', processedCode: '9400123456789012345678' }
            ];
            
            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbzsoQ_1QyVC09mTBAgLt7KXK9kooB6zvwlOfBOOqRXMD_EiQf3m6mOhdLYcLSMwqS4v/AKfycby6-gUV8LaKPnDDBGT5U5nC3WR4KnNb-4-E4Q6rY-trAMcabRzw4gCOa8S582NpPMNn/exec", {
                    method: "POST",
                    body: JSON.stringify(testData),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                
                if (response.ok) {
                    const responseText = await response.text();
                    result.innerHTML = `âœ… æ‰¹é‡ä¸Šä¼ æˆåŠŸï¼<br>ä¸Šä¼ äº† ${testData.length} æ¡è®°å½•<br>å“åº”: ${responseText}`;
                    result.className = 'success';
                } else {
                    result.innerHTML = `âŒ æ‰¹é‡ä¸Šä¼ å¤±è´¥ï¼<br>çŠ¶æ€ç : ${response.status}<br>çŠ¶æ€æ–‡æœ¬: ${response.statusText}`;
                    result.className = 'error';
                }
            } catch (error) {
                result.innerHTML = `âŒ ç½‘ç»œé”™è¯¯ï¼<br>é”™è¯¯ä¿¡æ¯: ${error.message}`;
                result.className = 'error';
            }
        }
    </script>
</body>
</html>