<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«é€’æ‰«ç å·¥å…· - å¿«é€Ÿå¯åŠ¨</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 { text-align: center; margin-bottom: 30px; }
        .method {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
        }
        .method h3 { margin-top: 0; color: #4CAF50; }
        .code {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
        }
        .button {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
        }
        .button:hover { background: #45a049; }
        .error { background: rgba(255,0,0,0.2); border-left-color: #ff4444; }
        .warning { background: rgba(255,165,0,0.2); border-left-color: #ffa500; }
        .success { background: rgba(0,255,0,0.2); border-left-color: #00ff00; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ å¿«é€’æ‰«ç å·¥å…· - å¿«é€Ÿå¯åŠ¨æŒ‡å—</h1>
        
        <div class="method error">
            <h3>âŒ å½“å‰é—®é¢˜</h3>
            <p>æ‚¨é‡åˆ°äº† <strong>"Failed to fetch"</strong> é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºç›´æ¥æ‰“å¼€HTMLæ–‡ä»¶ä¼šé‡åˆ°CORSè·¨åŸŸé™åˆ¶ã€‚</p>
        </div>

        <div class="method success">
            <h3>âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨æœ¬åœ°HTTPæœåŠ¡å™¨ï¼ˆæ¨èï¼‰</h3>
            
            <h4>ğŸ å¦‚æœæ‚¨æœ‰Pythonï¼š</h4>
            <div class="code">python -m http.server 8000</div>
            <p>ç„¶åè®¿é—®ï¼š<a href="http://localhost:8000" class="button">http://localhost:8000</a></p>
            
            <h4>ğŸ“¦ å¦‚æœæ‚¨æœ‰Node.jsï¼š</h4>
            <div class="code">npx http-server -p 8000</div>
            <p>ç„¶åè®¿é—®ï¼š<a href="http://localhost:8000" class="button">http://localhost:8000</a></p>
            
            <h4>ğŸ–¥ï¸ ä½¿ç”¨è„šæœ¬ï¼š</h4>
            <p>Windows: åŒå‡» <code>start-server.bat</code></p>
            <p>Linux/Mac: è¿è¡Œ <code>./start-server.sh</code></p>
        </div>

        <div class="method warning">
            <h3>ğŸŒ è§£å†³æ–¹æ¡ˆ2ï¼šåœ¨çº¿éƒ¨ç½²</h3>
            <p>å°†æ–‡ä»¶ä¸Šä¼ åˆ°ä»¥ä¸‹ä»»ä¸€å¹³å°ï¼š</p>
            <a href="https://pages.github.com/" class="button">GitHub Pages</a>
            <a href="https://www.netlify.com/" class="button">Netlify</a>
            <a href="https://vercel.com/" class="button">Vercel</a>
            <a href="https://surge.sh/" class="button">Surge.sh</a>
        </div>

        <div class="method">
            <h3>ğŸ”§ è§£å†³æ–¹æ¡ˆ3ï¼šæ›´æ–°Google Apps Script</h3>
            <p>ä½¿ç”¨æ”¯æŒCORSçš„ç‰ˆæœ¬ï¼š</p>
            <ol>
                <li>å¤åˆ¶ <code>google-apps-script-cors.js</code> ä¸­çš„ä»£ç </li>
                <li>æ›¿æ¢æ‚¨ç°æœ‰çš„Google Apps Scriptä»£ç </li>
                <li>é‡æ–°éƒ¨ç½²Webåº”ç”¨</li>
            </ol>
        </div>

        <div class="method">
            <h3>ğŸ§ª æµ‹è¯•è¿æ¥</h3>
            <button onclick="testConnection()" class="button">æµ‹è¯•Google Sheetsè¿æ¥</button>
            <div id="test-result" style="margin-top: 10px;"></div>
        </div>

        <div class="method">
            <h3>ğŸ“± å¿«é€Ÿè®¿é—®</h3>
            <a href="index.html" class="button">ä¸»æ‰«ç å·¥å…·</a>
            <a href="test-upload.html" class="button">æµ‹è¯•ä¸Šä¼ </a>
            <a href="DEPLOYMENT_GUIDE.md" class="button">éƒ¨ç½²æŒ‡å—</a>
        </div>
    </div>

    <script>
        async function testConnection() {
            const result = document.getElementById('test-result');
            result.innerHTML = 'ğŸ”„ æ­£åœ¨æµ‹è¯•è¿æ¥...';
            
            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbwXpnic2wOHYIzer4HIgMxMmV4v569Csg6pwmIo2cnFnB--ADvahjbKbFxGUSzgpM9D/exec", {
                    method: "POST",
                    body: JSON.stringify([{
                        expressType: 'TEST',
                        processedCode: 'CONNECTION_TEST_' + Date.now()
                    }]),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                
                if (response.ok) {
                    result.innerHTML = 'âœ… è¿æ¥æˆåŠŸï¼Google Sheetsé›†æˆæ­£å¸¸å·¥ä½œ';
                    result.style.color = '#4CAF50';
                } else {
                    result.innerHTML = `âŒ è¿æ¥å¤±è´¥ï¼çŠ¶æ€ç : ${response.status}`;
                    result.style.color = '#ff4444';
                }
            } catch (error) {
                result.innerHTML = `âŒ è¿æ¥é”™è¯¯: ${error.message}<br><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨HTTPæœåŠ¡å™¨è¿è¡Œ</strong>`;
                result.style.color = '#ff4444';
            }
        }

        // æ£€æµ‹å½“å‰è¿è¡Œç¯å¢ƒ
        if (location.protocol === 'file:') {
            document.body.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)';
            document.querySelector('h1').innerHTML += '<br><small style="color: #ffeb3b;">âš ï¸ æ£€æµ‹åˆ°file://åè®®ï¼Œéœ€è¦ä½¿ç”¨HTTPæœåŠ¡å™¨</small>';
        } else {
            document.querySelector('h1').innerHTML += '<br><small style="color: #4CAF50;">âœ… æ£€æµ‹åˆ°HTTPåè®®ï¼Œç¯å¢ƒæ­£å¸¸</small>';
        }
    </script>
</body>
</html>